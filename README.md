# sampleFileGenerator_var2.0
README  <sample_file_generator.exe>

システム概要
　sample_file_generator.exeは、変換定義書からサンプルファイルを作成するツールです。
　変換定義書を環境に適用するときのエラーチェックは、「変換詳細情報」の内容そのものにまでは及んでおりません。そのため、設定者自らその変換がうまくいくかどうかを確認する必要があります。
　いざ変換検証を行おうとする際に、手元にデータがない場合、設定者はデータを用意する必要があります。しかし、utf-8、ms932といった文字コードを考慮したり、YYYY/MM/DDなのかYYYYMMDDなのかといった日付形式に気をつけたり、ヘッダーのカラム位置を考慮してのファイルの作成したなど、「変換検証」という本質とズレた面倒な作業が必要だったりします。また。いざサンプルデータを作成しても仕様変更に伴い作成のやり直しをせざるを得なかったり、作成したサンプルデータの管理がおろそかになったりといった問題も存在します。

　今回作成したツールは、そういった「面倒さ」を少しでも軽減させることを目的とし、変換定義の環境適用後スムーズに変換検証に移れるように工夫を凝らしたものとなっています。


機能
変換定義書を用意しましたので、実際にsample_file_generator.exeで処理を行ってみてください。
・sample_file_generatorをダブルクリックします。
・直後にコンソール画面が開きますが、その後ファイル選択ダイアログが開きます。
・basic_join.xlsxを選択します。
・処理が実行されます。
・選択した変換定義書と同じディレクトリにフォルダが作成され、中身にサンプルファイルが作成されています。

2018/10/01現在のsample_file_generator.exe Var2.0には以下のような機能によりサンプルファイルを作成できます。

詳細
- １　ヘッダーを自動作成	
　本ツールの目玉機能です。項目情報からヘッダーを作成します。ヘッダーのカラム位置が順番通りに上からに並んでいなくても順番を並び替えてカラム位置通りに作成します。また、一部番号が抜けていたりしていても問題ありません。抜けている場合には「*****」の記号で埋められます。ヘッダーがないファイルを作成する場合は、編集のしやすさを考慮し、ヘッダーを１行目に出力しますが、＜削除必須＞の文言がつきます。変換検証を行う際はヘッダーを削除してから取り込んでください。

- ２　出力は５行のデータ
　データ部分に出力されるデータは「12345」で統一されています。このサンプルデータは簡易的にデータコンバーターに即取り込むことはできますが、基本的には検証作業をする方による編集が施されることを前提にしています。「左から○文字目を抽出」といった際に目安になること、計算の際になるべく簡単になることを意識しました。

- ３　結合に使用するカラムをわかりやすく。
　結合に使用するカラムは「key_」の文字が付与されます。また、データはわかりやすく「11111」のように同じ数字の連続になっています。
　データ編集のしやすさに配慮しました。

- ４　日付形式に合わせてデータを作成。	
　日付の形式には20181001、もしくは2018/10/01などと表記したりしますが、変換定義書に日付の形式（YYYY/MM/DDなど）が決められている場合、作成日時でその形式にあった日付をデータに作成します。
	
- ５　MS932、UTF-8、EUC-JPの文字コードを区別してファイルを作成。	
　基本情報を元に、作成するファイルも文字コードを区別して作成します。ファイルを開く際には注意が必要です。
　このツールではMS932で編集された変換定義書を読み込む際に、utf-8に変更が失敗するとその文字を「？」に置き換える仕様となっています。データコンバーターでの読み込みが「カラム位置」ではないように設定されている場合、ご注意ください。

- ６　複数選択に対応
　ファイル選択ダイアログで変換定義書を複数選択することができます。

- ７　フォルダ名は作成日時	
　サンプルデータは選択した変換定義書と同じディレクトリ配下にフォルダが作成され、変換定義書ごとにフォルダが作成され、そのなかにファイルが作成されます。
　処理を実行した変換定義書の名称と実行日時がフォルダ名に付与されます。データ管理のしやすさに配慮しました。


※ 注意点
 var2.0では固定長ファイルには対応しておりません。出力は全てcsvファイルです。今後の機能強化にて対応予定です。


入出力
環境に一度適用された変換定義書で、HUEからダウンロードしたものを入力に使用してください。
変換定義書の「基本情報」と「項目情報」を元にファイル作成を行うため、環境適用が完了していないような「エラー内容」が含まれる可能性のあるものからはサンプルデータを作成できません。
なるべくダウンロード直後の変換定義書に処理を実行してください。



